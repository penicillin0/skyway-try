(this["webpackJsonpskyway-try"]=this["webpackJsonpskyway-try"]||[]).push([[0],{108:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),c=n(9),o=n.n(c),i=(n(79),n(80),n(12)),l=n(38),s=n.n(l),m=n(138),u=n(43),d=n.n(u),p=n(42),v=n.n(p),f=n(63),E=n.n(f),h=n(62),b=n.n(h),g=n(61),y=n.n(g),O=n(151),j=n(145),w=n(8),_=n(17),S=n.n(_),x=n(29),k=Object({NODE_ENV:"production",PUBLIC_URL:"/skyway-try",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0}).REACT_APP_BACKEND_API_BASE,C=function(){var e=Object(x.a)(S.a.mark((function e(t){var n;return S.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.json();case 2:if(n=e.sent,!t.ok){e.next=7;break}return e.abrupt("return",n);case 7:throw new Error(n.message);case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),B=function(){var e=Object(x.a)(S.a.mark((function e(){var t;return S.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("".concat(k,"/api/v1/event"),{credentials:"same-origin"});case 2:return t=e.sent,e.next=5,C(t);case 5:return e.abrupt("return",e.sent);case 6:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),N=function(e,t){return e/t>9/16},T=n(141),D=n(143),I=n(144),P=n(24),A=Object(m.a)((function(e){return{root:{flexGrow:1},eventList:{color:"#fff",textDecoration:"none"},eventListButton:{color:"#fff",marginLeft:8}}})),W=function(){var e=A();return r.a.createElement("div",{className:e.root},r.a.createElement(T.a,{position:"static"},r.a.createElement(D.a,{variant:"dense"},r.a.createElement(P.b,{to:"/skyway-try",className:e.eventList},r.a.createElement(I.a,{variant:"h6",color:"inherit"},"skyway-try")))))},R=Object(m.a)((function(e){return{root:{backgroundColor:"#ddd",width:"100%",height:100,display:"flex",justifyContent:"center",alignItems:"center"}}})),K=function(){var e=R();return r.a.createElement("div",{className:e.root},r.a.createElement("small",null,"\xa9 \u30b5\u30a4\u30d5\u30a1\u30fc\u6ecb\u8cc0\u57fc\u7389 a.k.a \u5185\u9678 All Rights Reserved"))},L=(n(57),Object(m.a)({wrapper:{display:"flex",flexDirection:"column",justifyContent:"space-between",height:"100%",minHeight:"100vh"},eventInfo:{margin:"24px 0"},action:{width:"100%",maxWidth:"1200px",display:"flex",padding:4,margin:"0 auto"},messageField:{backgroundColor:"#fff",width:"100%",margin:"0 4px"},messageButton:{marginLeft:8},root:{marginBottom:64}})),H=n(58),U=new s.a({key:Object({NODE_ENV:"production",PUBLIC_URL:"/skyway-try",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0}).REACT_APP_SKYWAY_API_KEY}),Y=function(){var e,t,n=L(),c=Object(w.f)().event_id,o=Object(a.useRef)(null),l=Object(a.useState)(null),s=Object(i.a)(l,2),m=s[0],u=s[1],p=Object(a.useState)(null),f=Object(i.a)(p,2),h=f[0],g=f[1],_=Object(a.useState)(null),S=Object(i.a)(_,2),x=(S[0],S[1],Object(a.useState)(null)),k=Object(i.a)(x,2),C=(k[0],k[1],Object(a.useState)(0)),B=Object(i.a)(C,2),T=(B[0],B[1]),D=Object(a.useState)(""),I=Object(i.a)(D,2),P=I[0],A=I[1],W=Object(a.useState)(!0),R=Object(i.a)(W,2),K=R[0],Y=R[1],M=Object(a.useState)(!1),J=Object(i.a)(M,2),V=J[0],z=J[1],F=Object(a.useState)(new Date("2020/01/01 00:00:00")),G=Object(i.a)(F,2),X=G[0],$=G[1],q=window.innerWidth,Q=window.innerHeight;N(Q,q)?(e=q,t=9*q/16):(t=Q,e=16*Q/9);var Z=e/80,ee=function(){K?(document.getElementById("screen").style.display="none",Y(!1)):(document.getElementById("screen").style.display="block",Y(!0))},te={width:e+"px",height:t+"px"};return r.a.createElement("div",{className:n.wrapper},r.a.createElement("div",{className:n.root},r.a.createElement("div",{id:"video-screen",style:m?te:Object.assign(te,{backgroundColor:"#aaa"})},r.a.createElement("video",{id:"video",className:n.video,width:e+"px",height:t+"px",autoPlay:!0,playsInline:!0,ref:o}),r.a.createElement("div",{id:"comment-screen-wrap"},r.a.createElement("div",{id:"screen"}))),r.a.createElement("div",{className:n.action},V?r.a.createElement(j.a,{onClick:function(){null!=m&&(m.close(),z(!1),u(null))},variant:"contained",color:"primary"},r.a.createElement(v.a,null)):r.a.createElement(j.a,{onClick:function(){var n=U.joinRoom(c,{mode:"sfu"});u(n),n.on("stream",(function(e){o.current.srcObject=e,n.on("peerLeave",(function(t){t===e.peerId?(n.close(),T(0),o.current.srcObject=null):T(n.members.length)}))}));var a=new H({app:document.getElementById("screen"),width:e,height:t,font_size:36,speed:8,color:"#fff"});g(a),a.listen(),n.on("data",(function(e){var t=e.src,n=e.data;console.log(t,n),n.length<25&&a.send({text:n,speed:Z})})),n.on("peerJoin",(function(e){T(n.members.length)})),n.on("open",(function(){T(n.members.length)})),z(!0)},variant:"contained",color:"primary"},r.a.createElement(d.a,null)),r.a.createElement(O.a,{className:n.messageField,value:P,onChange:function(e){A(e.target.value)},id:"standard-basic",label:"\u30b3\u30e1\u30f3\u30c8(25\u6587\u5b57\u4ee5\u5185)"}),r.a.createElement(j.a,{onClick:function(){if(P.length>25)alert("25\u6587\u5b57\u4ee5\u5185\u3067\u5165\u529b\u3057\u3066\u304f\u3060\u3055\u3044\u3002");else if(null!==m){var e=new Date;(e.getTime()-X.getTime())/1e3<5?alert("\u6570\u79d2\u304a\u5f85\u3061\u4e0b\u3055\u3044"):(m.send(P),document.getElementById("standard-basic").value=null,h.send({text:P,speed:Z,color:"#ff0000"}),A(""),$(e))}},variant:"contained",color:"primary"},r.a.createElement(y.a,null)),K?r.a.createElement(j.a,{className:n.messageButton,onClick:ee,variant:"contained",color:"primary",id:"commentDisplayButton"},r.a.createElement(b.a,null)):r.a.createElement(j.a,{className:n.messageButton,onClick:ee,variant:"contained",color:"primary",id:"commentDisplayButton"},r.a.createElement(E.a,{className:n.messageButton})))))},M=n(146),J=n(64),V=n.n(J),z=n(58),F=new s.a({key:Object({NODE_ENV:"production",PUBLIC_URL:"/skyway-try",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0}).REACT_APP_SKYWAY_API_KEY}),G=Object(m.a)({screen:{position:"relative",textAlign:"center"},camera:{position:"absolute",bottom:3,right:3},playBtn:{position:"absolute",bottom:3,left:3},eventInfo:{marginTop:24},commentBtn:{position:"absolute",left:"50%",bottom:6,transform:"translateX(-50%)"}}),X=function(){var e,t,n=G(),c=(Object(w.f)().event_id,Object(a.useRef)(null)),o=Object(a.useState)(null),l=Object(i.a)(o,2),s=l[0],m=l[1],u=Object(a.useState)(null),p=Object(i.a)(u,2),f=p[0],E=(p[1],Object(a.useState)(!0)),h=Object(i.a)(E,2),b=h[0],g=h[1],y=Object(a.useState)(!0),O=Object(i.a)(y,2),_=O[0],S=O[1],x=Object(a.useState)(!1),k=Object(i.a)(x,2),C=k[0],B=k[1],T=window.innerWidth,D=window.innerHeight;N(D,T)?(e=T,t=9*T/16):(t=D,e=16*D/9);var P=function(){_?(document.getElementById("screen").style.display="none",S(!1)):(document.getElementById("screen").style.display="block",S(!0))},A={width:e+"px",height:t+"px"};return r.a.createElement("div",null,r.a.createElement("div",{id:"video-screen",className:n.screen,style:C?A:Object.assign(A,{backgroundColor:"#aaa"})},r.a.createElement("video",{id:"video",width:e+"px",height:t+"px",autoPlay:!0,muted:!0,playsInline:!0,ref:c}),r.a.createElement("div",{id:"comment-screen-wrap"},r.a.createElement("div",{id:"screen"})),null!==s?r.a.createElement(M.a,{color:"primary","aria-label":"add",onClick:function(){g((function(e){return!e}));var e=!b;navigator.mediaDevices.getUserMedia({video:{width:{ideal:640},height:{ideal:360},facingMode:e?"environment":"user"},audio:!0}).then((function(e){s.replaceStream(e),c.current.srcObject=e}))},className:n.camera},r.a.createElement(V.a,null)):""),C?r.a.createElement(M.a,{color:"secondary",className:n.playBtn,onClick:function(){null!=s&&(s.close(),c.current.srcObject=null,m(null),B(!1))}},r.a.createElement(v.a,null)):r.a.createElement(M.a,{color:"primary",className:n.playBtn,onClick:function(){navigator.mediaDevices.getUserMedia({video:{width:{ideal:640},height:{ideal:360},facingMode:b?"environment":"user"},audio:!0}).then((function(n){c.current.srcObject=n;var a=F.joinRoom(1,{mode:"sfu",stream:n});m(a);var r=new z({app:document.getElementById("screen"),width:e,height:t,font_size:36,speed:8,color:"#fff"});r.listen(),a.on("data",(function(t){var n=t.src,a=t.data;console.log(n,a);var c=e/80;r.send({text:a,speed:c})}))})),B(!0)}},r.a.createElement(d.a,null)),_?r.a.createElement(j.a,{onClick:P,variant:"contained",color:"secondary",id:"commentDisplayButton",className:n.commentBtn},"\u30b3\u30e1\u30f3\u30c8\u975e\u8868\u793a"):r.a.createElement(j.a,{onClick:P,variant:"contained",color:"primary",id:"commentDisplayButton",className:n.commentBtn},"\u30b3\u30e1\u30f3\u30c8\u8868\u793a"),null!==f&&r.a.createElement("div",{className:n.eventInfo},r.a.createElement(I.a,{gutterBottom:!0,variant:"h5",component:"h2"},"\u4f1a\u793e\u540d\uff1a",f.company.name),r.a.createElement(I.a,{variant:"body2",color:"textSecondary",component:"p"},"\u958b\u59cb\u6642\u9593\uff1a",f.start_time)))},$=n(147),q=n(148),Q=n(150),Z=n(149),ee=Object(m.a)({wrapper:{display:"flex",flexDirection:"column",justifyContent:"space-between",height:"100%",minHeight:"100vh"},title:{marginTop:32},card:{maxWidth:600,margin:"40px auto"},media:{height:280},introduction:{marginTop:24}});Object(w.g)((function(e){var t=ee(),n=r.a.useState([]),a=Object(i.a)(n,2),c=a[0],o=a[1];r.a.useEffect((function(){(function(){var e=Object(x.a)(S.a.mark((function e(){var t;return S.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,B().catch((function(e){console.log(e.message)}));case 2:t=e.sent,o(t);case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}})()()}),[]);return r.a.createElement("div",{className:t.wrapper},r.a.createElement("div",{className:t.root},r.a.createElement(W,null),r.a.createElement(I.a,{className:t.title,gutterBottom:!0,variant:"h5",component:"h2"},"\u8996\u8074\u958b\u59cb"),c.map((function(n){return r.a.createElement($.a,{className:t.card,key:n.id},r.a.createElement(q.a,{onClick:function(){return t=n.id,void e.history.push("/event/".concat(t));var t}},r.a.createElement(Z.a,{className:t.media,image:n.image_url,title:"Contemplative Reptile"}),r.a.createElement(Q.a,null,r.a.createElement(I.a,{gutterBottom:!0,variant:"h5",component:"h2"},n.company.name),r.a.createElement(I.a,{variant:"body2",component:"p"},"\u958b\u50ac\u6642\u9593\uff1a",n.start_time),r.a.createElement(I.a,{className:t.introduction,variant:"body2",color:"textSecondary",component:"p"},n.introduction.length>99?n.introduction.substr(0,99)+"...":n.introduction))))}))),r.a.createElement(K,null))}));var te=function(){return r.a.createElement("div",{className:"App"},r.a.createElement(P.a,null,r.a.createElement(w.c,null,r.a.createElement(w.a,{exact:!0,path:"/event/:event_id/broadcast"},r.a.createElement(X,null)),r.a.createElement(w.a,{exact:!0,path:"/event/:event_id/viewer"},r.a.createElement(Y,null)),r.a.createElement(w.a,{path:"/"},r.a.createElement(Y,null)))))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));o.a.render(r.a.createElement(r.a.StrictMode,null,r.a.createElement(te,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))},57:function(e,t,n){},74:function(e,t,n){e.exports=n(108)},79:function(e,t,n){},80:function(e,t,n){}},[[74,1,2]]]);
//# sourceMappingURL=main.6f0dbf82.chunk.js.map