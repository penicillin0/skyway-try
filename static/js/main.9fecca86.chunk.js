(this["webpackJsonpskyway-try"]=this["webpackJsonpskyway-try"]||[]).push([[0],{108:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),c=a(9),o=a.n(c),i=(a(79),a(80),a(12)),l=a(38),s=a.n(l),m=a(138),u=a(43),d=a.n(u),p=a(42),v=a.n(p),f=a(63),h=a.n(f),E=a(62),g=a.n(E),y=a(61),b=a.n(y),O=a(151),w=a(145),j=a(8),_=a(17),x=a.n(_),S=a(29),k=Object({NODE_ENV:"production",PUBLIC_URL:"/skyway-try",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0}).REACT_APP_BACKEND_API_BASE,B=function(){var e=Object(S.a)(x.a.mark((function e(t){var a;return x.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.json();case 2:if(a=e.sent,!t.ok){e.next=7;break}return e.abrupt("return",a);case 7:throw new Error(a.message);case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),C=function(){var e=Object(S.a)(x.a.mark((function e(){var t;return x.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("".concat(k,"/api/v1/event"),{credentials:"same-origin"});case 2:return t=e.sent,e.next=5,B(t);case 5:return e.abrupt("return",e.sent);case 6:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),N=function(e,t){return e/t>9/16},T=a(141),D=a(143),I=a(144),P=a(24),A=Object(m.a)((function(e){return{root:{flexGrow:1},eventList:{color:"#fff",textDecoration:"none"},eventListButton:{color:"#fff",marginLeft:8}}})),W=function(){var e=A();return r.a.createElement("div",{className:e.root},r.a.createElement(T.a,{position:"static"},r.a.createElement(D.a,{variant:"dense"},r.a.createElement(P.b,{to:"/skyway-try",className:e.eventList},r.a.createElement(I.a,{variant:"h6",color:"inherit"},"skyway-try")))))},R=Object(m.a)((function(e){return{root:{backgroundColor:"#ddd",width:"100%",height:100,display:"flex",justifyContent:"center",alignItems:"center"}}})),K=function(){var e=R();return r.a.createElement("div",{className:e.root},r.a.createElement("small",null,"\xa9 \u30b5\u30a4\u30d5\u30a1\u30fc\u6ecb\u8cc0\u57fc\u7389 a.k.a \u5185\u9678 All Rights Reserved"))},L=(a(57),Object(m.a)({wrapper:{display:"flex",flexDirection:"column",justifyContent:"space-between",height:"100%",minHeight:"100vh"},eventInfo:{margin:"24px 0"},action:{width:"100%",maxWidth:"1200px",display:"flex",padding:4,margin:"0 auto"},messageField:{backgroundColor:"#fff",width:"100%",margin:"0 4px"},messageButton:{marginLeft:8},root:{marginBottom:64}})),H=a(58),U=new s.a({key:Object({NODE_ENV:"production",PUBLIC_URL:"/skyway-try",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0}).REACT_APP_SKYWAY_API_KEY}),Y=function(){var e,t,a=L(),c=Object(j.f)().event_id,o=Object(n.useRef)(null),l=Object(n.useState)(null),s=Object(i.a)(l,2),m=s[0],u=s[1],p=Object(n.useState)(null),f=Object(i.a)(p,2),E=f[0],y=f[1],_=Object(n.useState)(null),x=Object(i.a)(_,2),S=(x[0],x[1],Object(n.useState)(null)),k=Object(i.a)(S,2),B=(k[0],k[1],Object(n.useState)(0)),C=Object(i.a)(B,2),T=(C[0],C[1]),D=Object(n.useState)(""),I=Object(i.a)(D,2),P=I[0],A=I[1],W=Object(n.useState)(!0),R=Object(i.a)(W,2),K=R[0],Y=R[1],M=Object(n.useState)(!1),J=Object(i.a)(M,2),V=J[0],z=J[1],F=Object(n.useState)(new Date("2020/01/01 00:00:00")),G=Object(i.a)(F,2),X=G[0],$=G[1],q=window.innerWidth,Q=window.innerHeight;N(Q,q)?(e=q,t=9*q/16):(t=Q,e=16*Q/9);var Z=e/80,ee=function(){K?(document.getElementById("screen").style.display="none",Y(!1)):(document.getElementById("screen").style.display="block",Y(!0))},te={width:e+"px",height:t+"px"};return r.a.createElement("div",{className:a.wrapper},r.a.createElement("div",{className:a.root},r.a.createElement("div",{id:"video-screen",style:m?te:Object.assign(te,{backgroundColor:"#aaa"})},r.a.createElement("video",{id:"video",className:a.video,width:e+"px",height:t+"px",autoPlay:!0,playsInline:!0,ref:o}),r.a.createElement("div",{id:"comment-screen-wrap"},r.a.createElement("div",{id:"screen"}))),r.a.createElement("div",{className:a.action},V?r.a.createElement(w.a,{onClick:function(){null!=m&&(m.close(),z(!1),u(null))},variant:"contained",color:"primary"},r.a.createElement(v.a,null)):r.a.createElement(w.a,{onClick:function(){var a=U.joinRoom(c,{mode:"sfu"});u(a),a.on("stream",(function(e){o.current.srcObject=e,a.on("peerLeave",(function(t){t===e.peerId?(a.close(),T(0),o.current.srcObject=null):T(a.members.length)}))}));var n=new H({app:document.getElementById("screen"),width:e,height:t,font_size:36,speed:8,color:"#fff"});y(n),n.listen(),a.on("data",(function(e){var t=e.src,a=e.data;console.log(t,a),a.length<25&&n.send({text:a,speed:Z})})),a.on("peerJoin",(function(e){T(a.members.length)})),a.on("open",(function(){T(a.members.length)})),z(!0)},variant:"contained",color:"primary"},r.a.createElement(d.a,null)),r.a.createElement(O.a,{className:a.messageField,value:P,onChange:function(e){A(e.target.value)},id:"standard-basic",label:"\u30b3\u30e1\u30f3\u30c8(25\u6587\u5b57\u4ee5\u5185)"}),r.a.createElement(w.a,{onClick:function(){if(P.length>25)alert("25\u6587\u5b57\u4ee5\u5185\u3067\u5165\u529b\u3057\u3066\u304f\u3060\u3055\u3044\u3002");else if(null!==m){var e=new Date;(e.getTime()-X.getTime())/1e3<5?alert("\u6570\u79d2\u304a\u5f85\u3061\u4e0b\u3055\u3044"):(m.send(P),document.getElementById("standard-basic").value=null,E.send({text:P,speed:Z,color:"#ff0000"}),A(""),$(e))}},variant:"contained",color:"primary"},r.a.createElement(b.a,null)),K?r.a.createElement(w.a,{className:a.messageButton,onClick:ee,variant:"contained",color:"primary",id:"commentDisplayButton"},r.a.createElement(g.a,null)):r.a.createElement(w.a,{className:a.messageButton,onClick:ee,variant:"contained",color:"primary",id:"commentDisplayButton"},r.a.createElement(h.a,{className:a.messageButton})))))},M=a(146),J=a(64),V=a.n(J),z=a(58),F=new s.a({key:Object({NODE_ENV:"production",PUBLIC_URL:"/skyway-try",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0}).REACT_APP_SKYWAY_API_KEY}),G=Object(m.a)({screen:{position:"relative",textAlign:"center"},camera:{position:"absolute",bottom:3,right:3},playBtn:{position:"absolute",bottom:3,left:3},eventInfo:{marginTop:24},commentBtn:{position:"absolute",left:"50%",bottom:6,transform:"translateX(-50%)"}}),X=function(){var e,t,a=G(),c=(Object(j.f)().event_id,Object(n.useRef)(null)),o=Object(n.useState)(null),l=Object(i.a)(o,2),s=l[0],m=l[1],u=Object(n.useState)(null),p=Object(i.a)(u,2),f=p[0],h=(p[1],Object(n.useState)(!0)),E=Object(i.a)(h,2),g=E[0],y=E[1],b=Object(n.useState)(!0),O=Object(i.a)(b,2),_=O[0],x=O[1],S=Object(n.useState)(!1),k=Object(i.a)(S,2),B=k[0],C=k[1],T=window.innerWidth,D=window.innerHeight;N(D,T)?(e=T,t=9*T/16):(t=D,e=16*D/9);var P=function(){_?(document.getElementById("screen").style.display="none",x(!1)):(document.getElementById("screen").style.display="block",x(!0))},A={width:e+"px",height:t+"px"};return r.a.createElement("div",null,r.a.createElement("div",{id:"video-screen",className:a.screen,style:B?A:Object.assign(A,{backgroundColor:"#aaa"})},r.a.createElement("video",{id:"video",width:e+"px",height:t+"px",autoPlay:!0,muted:!0,playsInline:!0,ref:c}),r.a.createElement("div",{id:"comment-screen-wrap"},r.a.createElement("div",{id:"screen"})),null!==s?r.a.createElement(M.a,{color:"primary","aria-label":"add",onClick:function(){y((function(e){return!e}));var e=!g;navigator.mediaDevices.getUserMedia({video:{width:{ideal:640},height:{ideal:360},facingMode:e?"environment":"user"},audio:!0}).then((function(e){s.replaceStream(e),c.current.srcObject=e}))},className:a.camera},r.a.createElement(V.a,null)):""),B?r.a.createElement(M.a,{color:"secondary",className:a.playBtn,onClick:function(){null!=s&&(s.close(),c.current.srcObject=null,m(null),C(!1))}},r.a.createElement(v.a,null)):r.a.createElement(M.a,{color:"primary",className:a.playBtn,onClick:function(){navigator.mediaDevices.getUserMedia({video:{width:{ideal:640},height:{ideal:360},facingMode:g?"environment":"user"},audio:!0}).then((function(a){c.current.srcObject=a;var n=F.joinRoom(1,{mode:"sfu",stream:a});m(n);var r=new z({app:document.getElementById("screen"),width:e,height:t,font_size:36,speed:8,color:"#fff"});r.listen(),n.on("data",(function(t){var a=t.src,n=t.data;console.log(a,n);var c=e/80;r.send({text:n,speed:c})}))})),C(!0)}},r.a.createElement(d.a,null)),_?r.a.createElement(w.a,{onClick:P,variant:"contained",color:"secondary",id:"commentDisplayButton",className:a.commentBtn},"\u30b3\u30e1\u30f3\u30c8\u975e\u8868\u793a"):r.a.createElement(w.a,{onClick:P,variant:"contained",color:"primary",id:"commentDisplayButton",className:a.commentBtn},"\u30b3\u30e1\u30f3\u30c8\u8868\u793a"),null!==f&&r.a.createElement("div",{className:a.eventInfo},r.a.createElement(I.a,{gutterBottom:!0,variant:"h5",component:"h2"},"\u4f1a\u793e\u540d\uff1a",f.company.name),r.a.createElement(I.a,{variant:"body2",color:"textSecondary",component:"p"},"\u958b\u59cb\u6642\u9593\uff1a",f.start_time)))},$=function(){var e=Object(m.a)({wrapper:{display:"flex",flexDirection:"column",justifyContent:"space-between",height:"100%",minHeight:"100vh"},root:{height:480},title:{marginTop:32},card:{maxWidth:600,margin:"40px auto"},media:{height:280},introduction:{marginTop:24},enterButton:{marginBottom:32},footer:{width:"100%",position:"absolute",bottom:0},hiddenButton:{margin:"0 auto",width:200}})();Object(j.f)().event_id;return r.a.createElement("div",{className:e.wrapper},r.a.createElement("div",{className:e.root},r.a.createElement(W,null),r.a.createElement(I.a,{className:e.title,gutterBottom:!0,variant:"h5",component:"h2"},"skyway-try"),r.a.createElement(w.a,{className:e.enterButton,href:"/event/1/viewer",variant:"contained",color:"primary"},"go skyway-try!")))},q=a(147),Q=a(148),Z=a(150),ee=a(149),te=Object(m.a)({wrapper:{display:"flex",flexDirection:"column",justifyContent:"space-between",height:"100%",minHeight:"100vh"},title:{marginTop:32},card:{maxWidth:600,margin:"40px auto"},media:{height:280},introduction:{marginTop:24}});Object(j.g)((function(e){var t=te(),a=r.a.useState([]),n=Object(i.a)(a,2),c=n[0],o=n[1];r.a.useEffect((function(){(function(){var e=Object(S.a)(x.a.mark((function e(){var t;return x.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,C().catch((function(e){console.log(e.message)}));case 2:t=e.sent,o(t);case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}})()()}),[]);return r.a.createElement("div",{className:t.wrapper},r.a.createElement("div",{className:t.root},r.a.createElement(W,null),r.a.createElement(I.a,{className:t.title,gutterBottom:!0,variant:"h5",component:"h2"},"\u8996\u8074\u958b\u59cb"),c.map((function(a){return r.a.createElement(q.a,{className:t.card,key:a.id},r.a.createElement(Q.a,{onClick:function(){return t=a.id,void e.history.push("/event/".concat(t));var t}},r.a.createElement(ee.a,{className:t.media,image:a.image_url,title:"Contemplative Reptile"}),r.a.createElement(Z.a,null,r.a.createElement(I.a,{gutterBottom:!0,variant:"h5",component:"h2"},a.company.name),r.a.createElement(I.a,{variant:"body2",component:"p"},"\u958b\u50ac\u6642\u9593\uff1a",a.start_time),r.a.createElement(I.a,{className:t.introduction,variant:"body2",color:"textSecondary",component:"p"},a.introduction.length>99?a.introduction.substr(0,99)+"...":a.introduction))))}))),r.a.createElement(K,null))}));var ae=function(){return r.a.createElement("div",{className:"App"},r.a.createElement(P.a,null,r.a.createElement(j.c,null,r.a.createElement(j.a,{exact:!0,path:"/event/:event_id/broadcast"},r.a.createElement(X,null)),r.a.createElement(j.a,{exact:!0,path:"/event/:event_id/viewer"},r.a.createElement(Y,null)),r.a.createElement(j.a,{path:"/"},r.a.createElement($,null)))))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));o.a.render(r.a.createElement(r.a.StrictMode,null,r.a.createElement(ae,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))},57:function(e,t,a){},74:function(e,t,a){e.exports=a(108)},79:function(e,t,a){},80:function(e,t,a){}},[[74,1,2]]]);
//# sourceMappingURL=main.9fecca86.chunk.js.map