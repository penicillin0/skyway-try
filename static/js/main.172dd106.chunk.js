(this["webpackJsonpskyway-try"]=this["webpackJsonpskyway-try"]||[]).push([[0],{108:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),c=a(9),o=a.n(c),i=(a(79),a(80),a(12)),l=a(38),s=a.n(l),m=a(138),u=a(43),d=a.n(u),p=a(42),f=a.n(p),v=a(63),b=a.n(v),h=a(62),g=a.n(h),E=a(61),y=a.n(E),j=a(151),w=a(145),O=a(8),x=a(17),k=a.n(x),B=a(29),N=function(){var e=Object(B.a)(k.a.mark((function e(t){var a;return k.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.json();case 2:if(a=e.sent,!t.ok){e.next=7;break}return e.abrupt("return",a);case 7:throw new Error(a.message);case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),C=function(){var e=Object(B.a)(k.a.mark((function e(){var t;return k.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("".concat("http://localhost:1991","/api/v1/event"),{credentials:"same-origin"});case 2:return t=e.sent,e.next=5,N(t);case 5:return e.abrupt("return",e.sent);case 6:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),S=function(e,t){return e/t>9/16},I=a(141),D=a(143),R=a(144),_=a(24),L=Object(m.a)((function(e){return{root:{flexGrow:1},eventList:{color:"#fff",textDecoration:"none"},eventListButton:{color:"#fff",marginLeft:8}}})),W=function(){var e=L();return r.a.createElement("div",{className:e.root},r.a.createElement(I.a,{position:"static"},r.a.createElement(D.a,{variant:"dense"},r.a.createElement(_.b,{to:"/skyway-try",className:e.eventList},r.a.createElement(R.a,{variant:"h6",color:"inherit"},"skyway-try")))))},M=Object(m.a)((function(e){return{root:{backgroundColor:"#ddd",width:"100%",height:100,display:"flex",justifyContent:"center",alignItems:"center"}}})),T=function(){var e=M();return r.a.createElement("div",{className:e.root},r.a.createElement("small",null,"\xa9 \u30b5\u30a4\u30d5\u30a1\u30fc\u6ecb\u8cc0\u57fc\u7389 a.k.a \u5185\u9678 All Rights Reserved"))},H=(a(57),Object(m.a)({wrapper:{display:"flex",flexDirection:"column",justifyContent:"space-between",height:"100%",minHeight:"100vh"},eventInfo:{margin:"24px 0"},action:{width:"100%",maxWidth:"1200px",display:"flex",padding:4,margin:"0 auto"},messageField:{backgroundColor:"#fff",width:"100%",margin:"0 4px"},messageButton:{marginLeft:8},root:{marginBottom:64}})),A=a(58),J=new s.a({key:"0e95c6b0-edb4-4681-a1ea-0b948bccb9dc"}),z=function(){var e,t,a=H(),c=(Object(O.f)().event_id,Object(n.useRef)(null)),o=Object(n.useState)(null),l=Object(i.a)(o,2),s=l[0],m=l[1],u=Object(n.useState)(null),p=Object(i.a)(u,2),v=p[0],h=p[1],E=Object(n.useState)(null),x=Object(i.a)(E,2),k=(x[0],x[1],Object(n.useState)(null)),B=Object(i.a)(k,2),N=(B[0],B[1],Object(n.useState)(0)),C=Object(i.a)(N,2),I=(C[0],C[1]),D=Object(n.useState)(""),R=Object(i.a)(D,2),_=R[0],L=R[1],W=Object(n.useState)(!0),M=Object(i.a)(W,2),T=M[0],z=M[1],F=Object(n.useState)(!1),P=Object(i.a)(F,2),U=P[0],G=P[1],X=Object(n.useState)(new Date("2020/01/01 00:00:00")),$=Object(i.a)(X,2),q=$[0],K=$[1],Q=window.innerWidth,V=window.innerHeight;S(V,Q)?(e=Q,t=9*Q/16):(t=V,e=16*V/9);var Y=e/80,Z=function(){T?(document.getElementById("screen").style.display="none",z(!1)):(document.getElementById("screen").style.display="block",z(!0))},ee={width:e+"px",height:t+"px"};return r.a.createElement("div",{className:a.wrapper},r.a.createElement("div",{className:a.root},r.a.createElement("div",{id:"video-screen",style:s?ee:Object.assign(ee,{backgroundColor:"#aaa"})},r.a.createElement("video",{id:"video",className:a.video,width:e+"px",height:t+"px",autoPlay:!0,playsInline:!0,ref:c}),r.a.createElement("div",{id:"comment-screen-wrap"},r.a.createElement("div",{id:"screen"}))),r.a.createElement("div",{className:a.action},U?r.a.createElement(w.a,{onClick:function(){null!=s&&(s.close(),G(!1),m(null))},variant:"contained",color:"primary"},r.a.createElement(f.a,null)):r.a.createElement(w.a,{onClick:function(){var a=J.joinRoom("test",{mode:"sfu"});m(a),a.on("stream",(function(e){c.current.srcObject=e,a.on("peerLeave",(function(t){t===e.peerId?(a.close(),I(0),c.current.srcObject=null):I(a.members.length)}))}));var n=new A({app:document.getElementById("screen"),width:e,height:t,font_size:36,speed:8,color:"#fff"});h(n),n.listen(),a.on("data",(function(e){var t=e.src,a=e.data;console.log(t,a),a.length<25&&n.send({text:a,speed:Y})})),a.on("peerJoin",(function(e){I(a.members.length)})),a.on("open",(function(){I(a.members.length)})),G(!0)},variant:"contained",color:"primary"},r.a.createElement(d.a,null)),r.a.createElement(j.a,{className:a.messageField,value:_,onChange:function(e){L(e.target.value)},id:"standard-basic",label:"\u30b3\u30e1\u30f3\u30c8(25\u6587\u5b57\u4ee5\u5185)"}),r.a.createElement(w.a,{onClick:function(){if(_.length>25)alert("25\u6587\u5b57\u4ee5\u5185\u3067\u5165\u529b\u3057\u3066\u304f\u3060\u3055\u3044\u3002");else if(null!==s){var e=new Date;(e.getTime()-q.getTime())/1e3<5?alert("\u6570\u79d2\u304a\u5f85\u3061\u4e0b\u3055\u3044"):(s.send(_),document.getElementById("standard-basic").value=null,v.send({text:_,speed:Y,color:"#ff0000"}),L(""),K(e))}},variant:"contained",color:"primary"},r.a.createElement(y.a,null)),T?r.a.createElement(w.a,{className:a.messageButton,onClick:Z,variant:"contained",color:"primary",id:"commentDisplayButton"},r.a.createElement(g.a,null)):r.a.createElement(w.a,{className:a.messageButton,onClick:Z,variant:"contained",color:"primary",id:"commentDisplayButton"},r.a.createElement(b.a,{className:a.messageButton})))))},F=a(146),P=a(64),U=a.n(P),G=a(58),X=new s.a({key:"0e95c6b0-edb4-4681-a1ea-0b948bccb9dc"}),$=Object(m.a)({screen:{position:"relative",textAlign:"center"},camera:{position:"absolute",bottom:3,right:3},playBtn:{position:"absolute",bottom:3,left:3},eventInfo:{marginTop:24},commentBtn:{position:"absolute",left:"50%",bottom:6,transform:"translateX(-50%)"}}),q=function(){var e,t,a=$(),c=(Object(O.f)().event_id,Object(n.useRef)(null)),o=Object(n.useState)(null),l=Object(i.a)(o,2),s=l[0],m=l[1],u=Object(n.useState)(null),p=Object(i.a)(u,2),v=p[0],b=(p[1],Object(n.useState)(!0)),h=Object(i.a)(b,2),g=h[0],E=h[1],y=Object(n.useState)(!0),j=Object(i.a)(y,2),x=j[0],k=j[1],B=Object(n.useState)(!1),N=Object(i.a)(B,2),C=N[0],I=N[1],D=window.innerWidth,_=window.innerHeight;S(_,D)?(e=D,t=9*D/16):(t=_,e=16*_/9);var L=function(){x?(document.getElementById("screen").style.display="none",k(!1)):(document.getElementById("screen").style.display="block",k(!0))},W={width:e+"px",height:t+"px"};return r.a.createElement("div",null,r.a.createElement("div",{id:"video-screen",className:a.screen,style:C?W:Object.assign(W,{backgroundColor:"#aaa"})},r.a.createElement("video",{id:"video",width:e+"px",height:t+"px",autoPlay:!0,muted:!0,playsInline:!0,ref:c}),r.a.createElement("div",{id:"comment-screen-wrap"},r.a.createElement("div",{id:"screen"})),null!==s?r.a.createElement(F.a,{color:"primary","aria-label":"add",onClick:function(){E((function(e){return!e}));var e=!g;navigator.mediaDevices.getUserMedia({video:{width:{ideal:640},height:{ideal:360},facingMode:e?"environment":"user"},audio:!0}).then((function(e){s.replaceStream(e),c.current.srcObject=e}))},className:a.camera},r.a.createElement(U.a,null)):""),C?r.a.createElement(F.a,{color:"secondary",className:a.playBtn,onClick:function(){null!=s&&(s.close(),c.current.srcObject=null,m(null),I(!1))}},r.a.createElement(f.a,null)):r.a.createElement(F.a,{color:"primary",className:a.playBtn,onClick:function(){navigator.mediaDevices.getUserMedia({video:{width:{ideal:640},height:{ideal:360},facingMode:g?"environment":"user"},audio:!0}).then((function(a){c.current.srcObject=a;var n=X.joinRoom("test",{mode:"sfu",stream:a});m(n);var r=new G({app:document.getElementById("screen"),width:e,height:t,font_size:36,speed:8,color:"#fff"});r.listen(),n.on("data",(function(t){var a=t.src,n=t.data;console.log(a,n);var c=e/80;r.send({text:n,speed:c})}))})),I(!0)}},r.a.createElement(d.a,null)),x?r.a.createElement(w.a,{onClick:L,variant:"contained",color:"secondary",id:"commentDisplayButton",className:a.commentBtn},"\u30b3\u30e1\u30f3\u30c8\u975e\u8868\u793a"):r.a.createElement(w.a,{onClick:L,variant:"contained",color:"primary",id:"commentDisplayButton",className:a.commentBtn},"\u30b3\u30e1\u30f3\u30c8\u8868\u793a"),null!==v&&r.a.createElement("div",{className:a.eventInfo},r.a.createElement(R.a,{gutterBottom:!0,variant:"h5",component:"h2"},"\u4f1a\u793e\u540d\uff1a",v.company.name),r.a.createElement(R.a,{variant:"body2",color:"textSecondary",component:"p"},"\u958b\u59cb\u6642\u9593\uff1a",v.start_time)))},K=a(147),Q=a(148),V=a(150),Y=a(149),Z=Object(m.a)({wrapper:{display:"flex",flexDirection:"column",justifyContent:"space-between",height:"100%",minHeight:"100vh"},title:{marginTop:32},card:{maxWidth:600,margin:"40px auto"},media:{height:280},introduction:{marginTop:24}});Object(O.g)((function(e){var t=Z(),a=r.a.useState([]),n=Object(i.a)(a,2),c=n[0],o=n[1];r.a.useEffect((function(){(function(){var e=Object(B.a)(k.a.mark((function e(){var t;return k.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,C().catch((function(e){console.log(e.message)}));case 2:t=e.sent,o(t);case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}})()()}),[]);return r.a.createElement("div",{className:t.wrapper},r.a.createElement("div",{className:t.root},r.a.createElement(W,null),r.a.createElement(R.a,{className:t.title,gutterBottom:!0,variant:"h5",component:"h2"},"\u8996\u8074\u958b\u59cb"),c.map((function(a){return r.a.createElement(K.a,{className:t.card,key:a.id},r.a.createElement(Q.a,{onClick:function(){return t=a.id,void e.history.push("/event/".concat(t));var t}},r.a.createElement(Y.a,{className:t.media,image:a.image_url,title:"Contemplative Reptile"}),r.a.createElement(V.a,null,r.a.createElement(R.a,{gutterBottom:!0,variant:"h5",component:"h2"},a.company.name),r.a.createElement(R.a,{variant:"body2",component:"p"},"\u958b\u50ac\u6642\u9593\uff1a",a.start_time),r.a.createElement(R.a,{className:t.introduction,variant:"body2",color:"textSecondary",component:"p"},a.introduction.length>99?a.introduction.substr(0,99)+"...":a.introduction))))}))),r.a.createElement(T,null))}));var ee=function(){return r.a.createElement("div",{className:"App"},r.a.createElement(_.a,null,r.a.createElement(O.c,null,r.a.createElement(O.a,{exact:!0,path:"/broadcast"},r.a.createElement(q,null)),r.a.createElement(O.a,{exact:!0,path:"/viewer"},r.a.createElement(z,null)),r.a.createElement(O.a,{path:"/"},r.a.createElement(z,null)))))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));o.a.render(r.a.createElement(r.a.StrictMode,null,r.a.createElement(ee,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))},57:function(e,t,a){},74:function(e,t,a){e.exports=a(108)},79:function(e,t,a){},80:function(e,t,a){}},[[74,1,2]]]);
//# sourceMappingURL=main.172dd106.chunk.js.map